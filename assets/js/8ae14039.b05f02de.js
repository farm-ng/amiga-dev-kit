"use strict";(self.webpackChunkamiga_developers_website=self.webpackChunkamiga_developers_website||[]).push([[5112],{4798:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>t,metadata:()=>c,toc:()=>l});var a=i(4848),r=i(8453);const t={id:"camera-calibration",title:"Camera Calibration"},s=void 0,c={id:"examples/camera_calibration/camera-calibration",title:"Camera Calibration",description:"Before diving into this code, here's a quick heads-up on what you'll need to be familiar with:",source:"@site/docs/examples/camera_calibration/README.md",sourceDirName:"examples/camera_calibration",slug:"/examples/camera_calibration/",permalink:"/docs/examples/camera_calibration/",draft:!1,unlisted:!1,editUrl:"https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/examples/camera_calibration/README.md",tags:[],version:"current",frontMatter:{id:"camera-calibration",title:"Camera Calibration"},sidebar:"examples",previous:{title:"Camera Settings",permalink:"/docs/examples/camera_settings/"},next:{title:"Camera Aruco Detector",permalink:"/docs/examples/camera_aruco_detector/"}},o={},l=[{value:"1. Install the farm-ng Brain ADK package",id:"1-install-the-farm-ng-brain-adk-package",level:3},{value:"2. Setup",id:"2-setup",level:3},{value:"3. Install the example&#39;s dependencies",id:"3-install-the-examples-dependencies",level:3},{value:"4. Execute the Python script",id:"4-execute-the-python-script",level:3},{value:"5. Customize run",id:"5-customize-run",level:3},{value:"6. Code overview",id:"6-code-overview",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.admonition,{title:"Basic Knowledge Requirements",type:"info",children:[(0,a.jsx)(n.p,{children:"Before diving into this code, here's a quick heads-up on what you'll need to be familiar with:"}),(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Python Programming"}),": It's important to have a good grasp of Python, especially with concepts\nlike ",(0,a.jsx)(n.code,{children:"functions"}),", ",(0,a.jsx)(n.code,{children:"loops"}),", and ",(0,a.jsx)(n.code,{children:"classes"}),", since the example utilizes these fundamentals."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Asynchronous Programming with asyncio"}),": Familiarity with Python's asyncio for writing concurrent\ncode using the ",(0,a.jsx)(n.code,{children:"async/await"})," syntax."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Camera Calibration Concepts"}),": Basic knowledge about camera calibration, including what it is\nand why it's important, will help you understand the context and the results returned by the example."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/concepts/oak_service/",children:"farm-ng Oak Service Overview"})}),":\nThis overview provides a base understanding of the gRPC service the client you create will connect to."]}),"\n"]})]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"https://github.com/farm-ng/farm-ng-amiga/blob/main/py/examples/camera_calibration/main.py",children:(0,a.jsx)(n.strong,{children:"Camera Calibration"})}),"\nexample operates as a standalone Python script,\nin which an ",(0,a.jsx)(n.code,{children:"EventClient"})," to an Oak camera service running on an Amiga brain is created.\nThe calibration of the Oak camera is printed in the terminal."]}),"\n",(0,a.jsxs)(n.p,{children:["You can either run this example directly on a brain by ",(0,a.jsx)(n.code,{children:"ssh"}),"'ing in,\nor use your local PC.\nIf using your local PC, it should be either connected to the same local network as the brain\nor linked to it through ",(0,a.jsxs)(n.a,{href:"https://tailscale.com/",children:[(0,a.jsx)(n.strong,{children:"tailscale"}),"."]})]}),"\n",(0,a.jsxs)(n.p,{children:["Ensure that a ",(0,a.jsx)(n.a,{href:"/docs/brain/",children:(0,a.jsx)(n.strong,{children:"farm-ng brain"})})," running Oak cameras is active."]}),"\n",(0,a.jsxs)(n.h3,{id:"1-install-the-farm-ng-brain-adk-package",children:["1. Install the ",(0,a.jsx)(n.a,{href:"/docs/brain/brain-install",children:"farm-ng Brain ADK package"})]}),"\n",(0,a.jsx)(n.h3,{id:"2-setup",children:"2. Setup"}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsx)(n.p,{children:"It is recommended to also install these dependencies and run the\nexample in the brain ADK virtual environment."})}),"\n",(0,a.jsx)(n.p,{children:"Create first a virtual environment"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python3 -m venv venv\nsource venv/bin/activate\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# assuming you're already in the amiga-dev-kit/ directory\ncd farm-ng-amiga/py/examples/camera_calibration\n"})}),"\n",(0,a.jsx)(n.h3,{id:"3-install-the-examples-dependencies",children:"3. Install the example's dependencies"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pip3 install -r requirements.txt\n"})}),"\n",(0,a.jsx)(n.h3,{id:"4-execute-the-python-script",children:"4. Execute the Python script"}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsxs)(n.p,{children:["To run this script from your PC, you need to update the ",(0,a.jsx)(n.code,{children:"service_config.json"}),"\nby modifying the ",(0,a.jsx)(n.code,{children:"host"})," field with your Amiga brain name."]}),(0,a.jsxs)(n.p,{children:["Please check out ",(0,a.jsx)(n.a,{href:"/docs/concepts/system_overview/#where-to-run-the-examples",children:"Amiga Development 101"}),"\nfor more details."]})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python3 main.py --service-config service_config.json\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5-customize-run",children:"5. Customize run"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# usage: amiga-camera-calibration [-h] --service-config SERVICE_CONFIG\n#\n# optional arguments:\n#   -h, --help            show this help message and exit\n#   --service-config SERVICE_CONFIG\n#                         The camera config.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"6-code-overview",children:"6. Code overview"}),"\n",(0,a.jsxs)(n.p,{children:["In this example we use the ",(0,a.jsx)(n.code,{children:"EventClient"})," with the ",(0,a.jsx)(n.code,{children:"request_reply"}),"\nmethod to receive the camera camera calibration.\nThe ",(0,a.jsx)(n.code,{children:"request_reply"})," method is a coroutine that returns a ",(0,a.jsx)(n.code,{children:"Future"})," object.\nThe ",(0,a.jsx)(n.code,{children:"Future"})," object is used to retrieve the result of the request."]}),"\n",(0,a.jsxs)(n.p,{children:["The path to the calibration service is ",(0,a.jsx)(n.code,{children:"/calibration"})," and the request message is ",(0,a.jsx)(n.code,{children:"Empty"}),".\nThe response message is ",(0,a.jsx)(n.code,{children:"OakCalibration"}),", which is automatically decoded by the ",(0,a.jsx)(n.code,{children:"request_reply"}),"\nmethod using the ",(0,a.jsx)(n.code,{children:"decode=True"})," argument."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'async def main(service_config_path: Path) -> None:\n    """Request the camera calibration from the camera service.\n\n    Args:\n        service_config_path (Path): The path to the camera service config.\n    """\n    # create a client to the camera service\n    config: EventServiceConfig = proto_from_json_file(service_config_path, EventServiceConfig())\n\n    # get the calibration message\n    calibration: oak_pb2.OakCalibration =\n        await EventClient(config).request_reply("/calibration", Empty(), decode=True)\n    print(calibration)\n\n\nif __name__ == "__main__":\n    parser = argparse.ArgumentParser(prog="amiga-camera-calibration")\n    parser.add_argument("--service-config", type=Path, required=True, help="The camera config.")\n    args = parser.parse_args()\n\n    asyncio.run(main(args.service_config))\n'})}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["We highly recommend to have some basic knowledge about\n",(0,a.jsx)(n.a,{href:"https://docs.python.org/3/library/asyncio.html",children:(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"asyncio"})})}),"."]})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var a=i(6540);const r={},t=a.createContext(r);function s(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);