"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9945],{5162:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(7294),o=a(6010);const r="tabItem_Ymn6";function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,i),hidden:a},t)}},5488:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(7462),o=a(7294),r=a(6010),i=a(2389),l=a(7392),s=a(7094),p=a(2466);const m="tabList__CuJ",u="tabItem_LNqP";function c(e){var t,a;const{lazy:i,block:c,defaultValue:h,values:d,groupId:k,className:g}=e,y=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),N=null!=d?d:y.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),b=(0,l.l)(N,((e,t)=>e.value===t.value));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const f=null===h?h:null!=(t=null!=h?h:null==(a=y.find((e=>e.props.default)))?void 0:a.props.value)?t:y[0].props.value;if(null!==f&&!N.some((e=>e.value===f)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+f+'" but none of its children has the corresponding value. Available values are: '+N.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:v,setTabGroupChoices:w}=(0,s.U)(),[C,T]=(0,o.useState)(f),A=[],{blockElementScrollPositionUntilNextRender:x}=(0,p.o5)();if(null!=k){const e=v[k];null!=e&&e!==C&&N.some((t=>t.value===e))&&T(e)}const E=e=>{const t=e.currentTarget,a=A.indexOf(t),n=N[a].value;n!==C&&(x(t),T(n),null!=k&&w(k,String(n)))},I=e=>{var t;let a=null;switch(e.key){case"Enter":E(e);break;case"ArrowRight":{var n;const t=A.indexOf(e.currentTarget)+1;a=null!=(n=A[t])?n:A[0];break}case"ArrowLeft":{var o;const t=A.indexOf(e.currentTarget)-1;a=null!=(o=A[t])?o:A[A.length-1];break}}null==(t=a)||t.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",m)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":c},g)},N.map((e=>{let{value:t,label:a,attributes:i}=e;return o.createElement("li",(0,n.Z)({role:"tab",tabIndex:C===t?0:-1,"aria-selected":C===t,key:t,ref:e=>A.push(e),onKeyDown:I,onClick:E},i,{className:(0,r.Z)("tabs__item",u,null==i?void 0:i.className,{"tabs__item--active":C===t})}),null!=a?a:t)}))),i?(0,o.cloneElement)(y.filter((e=>e.props.value===C))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},y.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==C})))))}function h(e){const t=(0,i.Z)();return o.createElement(c,(0,n.Z)({key:String(t)},e))}},7009:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var n=a(7462),o=(a(7294),a(3905)),r=(a(1839),a(5488)),i=a(5162);const l={id:"brain-apps",title:"Developing Custom Applications"},s="Developing Custom Applications",p={unversionedId:"brain/brain-apps",id:"brain/brain-apps",title:"Developing Custom Applications",description:"We now have a full tutorial that walks you through creating custom applications that interact with cameras and drive your Amiga from the brain!",source:"@site/docs/brain/custom-applications.mdx",sourceDirName:"brain",slug:"/brain/brain-apps",permalink:"/docs/brain/brain-apps",draft:!1,editUrl:"https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/brain/custom-applications.mdx",tags:[],version:"current",frontMatter:{id:"brain-apps",title:"Developing Custom Applications"},sidebar:"docs",previous:{title:"Next Steps",permalink:"/docs/brain/next-steps"},next:{title:"Recommended Tools",permalink:"/docs/hardware-tools/recommended-tools"}},m={},u=[{value:"Quick Tips",id:"quick-tips",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initial Configuration",id:"initial-configuration",level:2},{value:"Prepare an app",id:"prepare-an-app",level:2},{value:"Select an app",id:"select-an-app",level:3},{value:"Create an app",id:"create-an-app",level:3},{value:"Create a repository from the template",id:"create-a-repository-from-the-template",level:4},{value:"Create an app from the app template",id:"create-an-app-from-the-app-template",level:4},{value:"Optional Test the app locally",id:"optional-test-the-app-locally",level:4},{value:"Live Code Syncing",id:"live-code-syncing",level:2}],c={toc:u};function h(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"developing-custom-applications"},"Developing Custom Applications"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"We now have a full tutorial that walks you through creating custom applications that interact with cameras and drive your Amiga from the brain!"),(0,o.kt)("p",{parentName:"admonition"},"Check it out at ",(0,o.kt)("a",{parentName:"p",href:"/docs/examples/virtual_joystick/virtual-joystick-overview"},"Virtual Joystick Tutorial"),".")),(0,o.kt)("h2",{id:"quick-tips"},"Quick Tips"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The Amiga user is able to install APT packages.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},'Edit the "entry.sh" script in the sample git repository.'))),(0,o.kt)("li",{parentName:"ul"},"We leverage a venv per application.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"The contents of requirements.txt will be installed by the bootstrap.sh script."))),(0,o.kt)("li",{parentName:"ul"},'If you\'ve updated the requirements.txt remove the hidden ".lock" before relaunching the app from the Brain UI.'),(0,o.kt)("li",{parentName:"ul"},"You may use VSCode remote development/containers to edit directly on the Amiga brain as well.")),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"linux",label:"Linux/WSL",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"apt install wget\npython3 -m pip install --user cookiecutter\n"))),(0,o.kt)(i.Z,{value:"macos",label:"MacOs",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"brew install wget\nbrew install cookiecutter\n")))),(0,o.kt)("h2",{id:"initial-configuration"},"Initial Configuration"),(0,o.kt)("p",null,"To make ssh between our workstation and the Amiga easier, we'll add some configuration to our ssh on the workstation."),(0,o.kt)("p",null,"First check if a file ",(0,o.kt)("inlineCode",{parentName:"p"},"~/.ssh/config")," exists on your workstation.\n",(0,o.kt)("inlineCode",{parentName:"p"},"~/")," is the home folder on your workstation."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("ol",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ol"},"If this file does not exist, you'll have to create it.")),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~ # Navigate to your home folder\nls -a # Check for a folder called `.ssh/`\n")),(0,o.kt)("ol",{parentName:"admonition",start:2},(0,o.kt)("li",{parentName:"ol"},"If ",(0,o.kt)("inlineCode",{parentName:"li"},"~/.ssh/")," does not exist, run:")),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh-keygen # create ~/.ssh/ folder\n")),(0,o.kt)("ol",{parentName:"admonition",start:3},(0,o.kt)("li",{parentName:"ol"},"Create a file called ",(0,o.kt)("inlineCode",{parentName:"li"},"config")," (no extension) in ",(0,o.kt)("inlineCode",{parentName:"li"},"~/.ssh")))),(0,o.kt)("p",null,"Add the following to your  ",(0,o.kt)("inlineCode",{parentName:"p"},"~/.ssh/config"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"Host amiga\n    HostName <ip address>\n    Port 22\n    User amiga\n    StrictHostKeyChecking no\n")),(0,o.kt)("admonition",{title:"tips",type:"tip"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"<ip address>")," can be found on the bottom right of the Amiga Brain screen"),(0,o.kt)("li",{parentName:"ul"},"Remove the ",(0,o.kt)("inlineCode",{parentName:"li"},"<")," & ",(0,o.kt)("inlineCode",{parentName:"li"},">")," symbols."),(0,o.kt)("li",{parentName:"ul"},"Your development station and your Amiga should be on the same network."))),(0,o.kt)("p",null,"This utilizes the IP address displayed on the bottom right of the brain display:"),(0,o.kt)("p",null,"Let\u2019s copy our keys to the robot as well (you may need to do this any time you are working with a new robot)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh-copy-id amiga\n")),(0,o.kt)("p",null,"Now you can ssh to the robot with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh amiga\nexit\n")),(0,o.kt)("admonition",{title:"troubleshooting",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"If, after a docker image update, you cannot ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh")," into your amiga or run the ",(0,o.kt)("inlineCode",{parentName:"p"},"sync.sh")," script,\nyou may have an error similar to:"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# $ ssh amiga\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\nSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\nIt is also possible that a host key has just been changed.\nThe fingerprint for the ECDSA key sent by the remote host is\nSHA256:QsdOvROYuKMa5NqaPTFHwF3kfPCwKaTzgBAj9N/eKCI.\nPlease contact your system administrator.\nAdd correct host key in /home/<YOUR_NAME>/.ssh/known_hosts to get rid of this message.\nOffending ECDSA key in /home/<YOUR_NAME>/.ssh/known_hosts:29\n  remove with:\n  ssh-keygen -f "/home/<YOUR_NAME>/.ssh/known_hosts" -R "192.168.XX.XX"\nECDSA host key for 192.168.XX.XX has changed and you have requested strict checking.\nHost key verification failed.\n')),(0,o.kt)("p",{parentName:"admonition"},"Follow the instructions they provide and run:"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'ssh-keygen -f "/home/<YOUR_NAME>/.ssh/known_hosts" -R "192.168.XX.XX"\n# With correct values for <YOUR_NAME> and IP Address XX.XX\n')),(0,o.kt)("p",{parentName:"admonition"},"You should now be able to ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh")," into your amiga and/or run the ",(0,o.kt)("inlineCode",{parentName:"p"},"sync.sh")," script")),(0,o.kt)("h2",{id:"prepare-an-app"},"Prepare an app"),(0,o.kt)("p",null,"Follow the instructions below to select an example from the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/farm-ng-amiga/tree/main/py/examples"},(0,o.kt)("inlineCode",{parentName:"a"},"farm-ng-amiga")," examples")," or create an app from the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/amiga-app-template"},(0,o.kt)("inlineCode",{parentName:"a"},"amiga-app-template"))," repository."),(0,o.kt)("h3",{id:"select-an-app"},"Select an app"),(0,o.kt)("admonition",{title:"coming soon",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"The folder structure of the examples in ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/farm-ng-amiga/tree/main/py/examples"},"farm-ng-amiga examples")," will soon be updated to match\nthe template repository for setup / install on the amiga."),(0,o.kt)("p",{parentName:"admonition"},"In the meantime, follow the instructions to ",(0,o.kt)("a",{parentName:"p",href:"#create-an-app"},"Create an app"),".\nYou can then copy the ",(0,o.kt)("inlineCode",{parentName:"p"},"main.py"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"requirements.txt"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"assets/")," directory (if present)\nfrom the example and drop them into an app you create with the template repository.")),(0,o.kt)("h3",{id:"create-an-app"},"Create an app"),(0,o.kt)("p",null,"Use the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/amiga-app-template"},(0,o.kt)("inlineCode",{parentName:"a"},"amiga-app-template"))," repository to create your own custom application with the following instructions."),(0,o.kt)("h4",{id:"create-a-repository-from-the-template"},"Create a repository from the template"),(0,o.kt)("p",null,"Navigate to the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/amiga-app-template"},(0,o.kt)("inlineCode",{parentName:"a"},"amiga-app-template"))," repository on GitHub."),(0,o.kt)("p",null,"Click on green ",(0,o.kt)("em",{parentName:"p"},"Use this template")," button (top right) to create a new repository based on this repo"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/5157099/205272492-356c1540-948e-43dc-8f60-8992caa8d511.gif",alt:"Create a new templated repository"})),(0,o.kt)("p",null,"Fill in the details, example below:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Owner: ",(0,o.kt)("em",{parentName:"li"},"username")),(0,o.kt)("li",{parentName:"ul"},"Repository Name: hello-amiga (names should be between 4-17 characters)"),(0,o.kt)("li",{parentName:"ul"},"Set to Public")),(0,o.kt)("p",null,"Once completed, click ",(0,o.kt)("em",{parentName:"p"},"[Create repository from template]")),(0,o.kt)("p",null,"When the repository creation process has completed, clone the repo to your local workspace"),(0,o.kt)("h4",{id:"create-an-app-from-the-app-template"},"Create an app from the app template"),(0,o.kt)("p",null,"You're now ready to create your first Kivy app, please choose a name between 4 and 17 characters run the ",(0,o.kt)("em",{parentName:"p"},"create app.sh")," script"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./create_app.sh\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Enter your full name"),(0,o.kt)("li",{parentName:"ol"},"press enter"),(0,o.kt)("li",{parentName:"ol"},"enter your chosen app name as well."),(0,o.kt)("li",{parentName:"ol"},"Press enter again"),(0,o.kt)("li",{parentName:"ol"},"Press enter once more to accept the formatted package name",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Or rename the package as you desire")))),(0,o.kt)("p",null,"Your kivy application has been created under the ",(0,o.kt)("em",{parentName:"p"},"apps")," directory"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ls apps/\n")),(0,o.kt)("h4",{id:"optional-test-the-app-locally"},"[Optional]"," Test the app locally"),(0,o.kt)("p",null,"Before any changes, lets see if we can run this app locally on your system."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"apps/<your app name>/entry.sh\n")),(0,o.kt)("p",null,"When running the above script, a virtual environment will be created under the ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"<application>"))," directory and any dependencies will be installed."),(0,o.kt)("p",null,"If all goes well, you'll see an empty kivy application on your screen."),(0,o.kt)("h2",{id:"live-code-syncing"},"Live Code Syncing"),(0,o.kt)("p",null,"Now we'll start a synchronization session that will mirror the code in this directory to an Apps directory (/data/apps) on the Amiga Brain. Note: This directory is persistent across reboots."),(0,o.kt)("p",null,"Our current sync process leverages Mutagen, the sync.sh script will set this up for you. Please provide your sudo password if required. This will copy the Mutagen binary and agents to your local filesystem.\nAdditional documentation regarding Mutagen may be viewed at: ",(0,o.kt)("a",{parentName:"p",href:"https://mutagen.io/documentation/introduction"},"Mutagen"),"."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Run this from the app directory where you'll find ",(0,o.kt)("inlineCode",{parentName:"p"},"sync.sh"),"!")),(0,o.kt)("p",null,"To start the synchronization process in the background:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./sync.sh -s start\n")),(0,o.kt)("p",null,"To stop the synchronization process:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./sync.sh -s stop\n")),(0,o.kt)("p",null,"Finally to view the status:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./sync.sh -s status\n")),(0,o.kt)("p",null,"While the sync process is running, any changes are mirrored to the Amiga Brain."),(0,o.kt)("p",null,'To test this process out, now that the current directory amiga-dev-kit/brain/examples/hello is being synchronized to your brain, lets trigger a refresh of the currently loaded apps by clicking on the "home" icon near the top right.'),(0,o.kt)("p",null,'Click on the new app labeled "Hello" on the Amiga Brain. After a brief moment (bootstrapping the app) the app will load and you\'ll be greeting a a simple UI app. Close the app by clicking "Exit".'),(0,o.kt)("p",null,'On your workstation, open the "main.py" file in an editor and change the value for YOUR_NAME to be your name (i.e. joe dirt). Save the file and relaunch the app from the Amiga Brain. The text will now reflect your changes.'))}h.isMDXComponent=!0}}]);