"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7256],{5328:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var r=i(7462),a=(i(7294),i(3905));i(1839);const n={id:"recorder-overview",title:"Recorder"},o="Recorder Service Overview",s={unversionedId:"concepts/recorder_service/recorder-overview",id:"concepts/recorder_service/recorder-overview",title:"Recorder",description:"The Recorder App/Service is the backbone of the Amiga's data logging and playback functionality.",source:"@site/docs/concepts/recorder_service/README.md",sourceDirName:"concepts/recorder_service",slug:"/concepts/recorder_service/",permalink:"/docs/concepts/recorder_service/",draft:!1,editUrl:"https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/concepts/recorder_service/README.md",tags:[],version:"current",frontMatter:{id:"recorder-overview",title:"Recorder"},sidebar:"Concepts",previous:{title:"Filter",permalink:"/docs/concepts/filter_service/"},next:{title:"Controller",permalink:"/docs/concepts/controller_service/"}},l={},c=[{value:"Purpose",id:"purpose",level:2},{value:"Subscriptions",id:"subscriptions",level:2},{value:"Available Topics for Recording",id:"available-topics-for-recording",level:2},{value:"Canbus Topics",id:"canbus-topics",level:3},{value:"Oak Topics",id:"oak-topics",level:3},{value:"GPS Topics",id:"gps-topics",level:3},{value:"Filter Topics",id:"filter-topics",level:3},{value:"Recording Profile",id:"recording-profile",level:2},{value:"API",id:"api",level:2},{value:"Data Storage",id:"data-storage",level:2},{value:"How to Use",id:"how-to-use",level:2}],p={toc:c};function d(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"recorder-service-overview"},"Recorder Service Overview"),(0,a.kt)("p",null,"The Recorder App/Service is the backbone of the Amiga's data logging and playback functionality.\nIt is designed to capture and store raw data from various robot services, facilitating later\nanalysis, debugging, and model training."),(0,a.kt)("h2",{id:"purpose"},"Purpose"),(0,a.kt)("p",null,"The primary objective of the Recorder Service is to provide a robust mechanism for recording\ndata streams from different services. This is invaluable for tasks such as training computer\nvision/AI models, where capturing field imagery is essential.\nFor instance, when developing a precision sprayer application for weeds, one would\nfirst traverse the field, recording data to train a model to detect weeds."),(0,a.kt)("h2",{id:"subscriptions"},"Subscriptions"),(0,a.kt)("p",null,"The Recorder Service is a subscriber to the following services:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Canbus"),(0,a.kt)("li",{parentName:"ul"},"Oak (Multiple Oak topics may be available, depending on the number of Oak cameras connected,\ne.g., oak0, oak1, ...)"),(0,a.kt)("li",{parentName:"ul"},"GPS Service"),(0,a.kt)("li",{parentName:"ul"},"Filter Service")),(0,a.kt)("h2",{id:"available-topics-for-recording"},"Available Topics for Recording"),(0,a.kt)("p",null,"The Recorder Service offers a variety of topics that can be recorded.\nEach topic provides specific data streams from the robot's various services.\nHere's a breakdown of each topic:"),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Check out the protobuf messages streamed on these topics at:",(0,a.kt)("br",null),"\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/farm-ng-amiga/tree/main-v2/protos/farm_ng"},(0,a.kt)("strong",{parentName:"a"},(0,a.kt)("inlineCode",{parentName:"strong"},"farm-ng-amiga/protos/"))),"."),(0,a.kt)("p",{parentName:"admonition"},"Some of which may inherit from the protobuf messages found at:",(0,a.kt)("br",null),"\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/farm-ng/farm-ng-core/tree/main/protos/farm_ng/core"},(0,a.kt)("strong",{parentName:"a"},(0,a.kt)("inlineCode",{parentName:"strong"},"farm-ng-core/protos/"))))),(0,a.kt)("h3",{id:"canbus-topics"},"Canbus Topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"canbus/health"),": Provides health metrics for the Canbus service, such as publishing frequency."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"canbus/raw_messages"),": Streams all messages received from the CAN bus by the canbus service.\nYou can parse and unpack these messages to see details of the motors (e.g., rpm, temperature),\nof your Amiga (e.g., battery voltage, velocity, whether auto-mode is engaged),\nand other pertinent information."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"canbus/twist"),": Outputs the linear and angular velocities of the robot, offering insights\ninto its movement dynamics.")),(0,a.kt)("h3",{id:"oak-topics"},"Oak Topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/health"),": Delivers health metrics for the Oak service, including publishing frequency."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/calibration"),": Streams the current calibration settings of the Oak device,\nensuring the camera's accuracy."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/disparity"),": Outputs the disparity image calculated from the left/right stereo images,\nused for depth perception and 3D mapping."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/imu"),": Streams 3-D accelerometer & gyroscope values from the Oak camera's internal IMU,\ngiving insights into the robot's orientation and movement."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/left"),": Outputs the feed from the stereo left camera of the Oak device."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/right"),": Outputs the feed from the stereo right camera of the Oak device."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oak/rgb"),": Streams the stereo RGB image from the Oak device, providing full-color\nvisuals of the robot's environment.")),(0,a.kt)("h3",{id:"gps-topics"},"GPS Topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"gps/health"),": Offers health metrics for the GPS service, such as publishing frequency."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"gps/pvt"),": Streams GPS Position, Velocity, and Time (PVT) messages, giving a comprehensive\nview of the robot's location and movement."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"gps/relposned"),": Provides GPS relative position in North, East, Down (N-E-D) coordinates,\noffering a detailed spatial orientation of the robot.")),(0,a.kt)("h3",{id:"filter-topics"},"Filter Topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"filter/health"),": Delivers health metrics for the Filter service, including publishing frequency."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"filter/state"),": Streams the filter state, which combines the robot's pose, orientation,\nfilter state uncertainties, and filter convergence status.\nThis topic is essential for understanding the robot's current state and its accuracy.")),(0,a.kt)("hr",null),(0,a.kt)("p",null,"These topics ensure that users have a comprehensive set of data streams to choose from,\ndepending on their specific needs and analysis requirements."),(0,a.kt)("h2",{id:"recording-profile"},"Recording Profile"),(0,a.kt)("p",null,'To initiate recording, a "Recording profile" must be provided as an argument.\nThis profile is a JSON file detailing the subscriptions or topics to be recorded. Here\'s an example:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "config": {\n        "name": "record_default",\n        "subscriptions": [\n            {\n            "uri": {\n                "path": "*",\n                "query": "service_name=canbus"\n            },\n            "every_n": 1\n            },\n            {\n            "uri": {\n                "path": "*",\n                "query": "service_name=gps"\n            },\n            "every_n": 1\n            },\n            {\n            "uri": {\n                "path": "/imu",\n                "query": "service_name=oak0"\n            },\n            "every_n": 1\n            },\n            {\n            "uri": {\n                "path": "*",\n                "query": "service_name=filter"\n            },\n            "every_n": 1\n            }\n        ]\n    }\n}\n')),(0,a.kt)("admonition",{title:"INFO",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"The ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"*"))," symbol in the ",(0,a.kt)("inlineCode",{parentName:"p"},"path")," field indicates that all available topics of that specific\nsubscription (service) should be recorded.")),(0,a.kt)("h2",{id:"api"},"API"),(0,a.kt)("p",null,"Users can interact with the Recorder Service using the following commands:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/start"),': Initiates data recording.\nA valid "Recording profile" must be provided as an argument.'),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/stop"),": Halts the data recording process.")),(0,a.kt)("h2",{id:"data-storage"},"Data Storage"),(0,a.kt)("p",null,"All recorded data is saved as binary files on the disk at /mnt/data.\nThe naming convention for these files captures the precise timestamp (to the microsecond)\nat the recording's start, the robot's name, and the file number in the sequence:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<yyyy>_<mm>_<dd>_<hh>_<mn>_<ss>_<msmsms>_<robot_name>.0000.bin\n")),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"2023_01_12_16_17_52_134845_element-vegetable.0000.bin\n")),(0,a.kt)("h2",{id:"how-to-use"},"How to Use"),(0,a.kt)("p",null,"Data can be recorded through the Recorder App, or using the ",(0,a.kt)("inlineCode",{parentName:"p"},"EventsClient")," class."),(0,a.kt)("p",null,"For a step-by-step guide on using the Recorder App, please refer to the\n",(0,a.kt)("a",{parentName:"p",href:"/docs/examples/import_log_file/"},"Record and Access Data example"),"."),(0,a.kt)("p",null,"For a step-by-step guide on recording data using the ",(0,a.kt)("inlineCode",{parentName:"p"},"EventsClient"),", please refer to the\n",(0,a.kt)("a",{parentName:"p",href:"/docs/examples/events_recorder/"},"Events Recorder example"),"."))}d.isMDXComponent=!0}}]);