"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=n.createContext({}),c=function(e){var t=n.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=c(e.components);return n.createElement(u.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=c(a),m=r,d=p["".concat(u,".").concat(m)]||p[m]||h[m]||o;return a?n.createElement(d,i(i({ref:t},s),{},{components:a})):n.createElement(d,i({ref:t},s))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=p;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5498:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=a(7462),r=(a(7294),a(3905));const o={},i=void 0,l={unversionedId:"mcu_kit/README",id:"mcu_kit/README",title:"README",description:"Feather M4 Can device setup",source:"@site/docs/mcu_kit/README.md",sourceDirName:"mcu_kit",slug:"/mcu_kit/",permalink:"/amiga-dev-kit/docs/mcu_kit/",draft:!1,editUrl:"https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/mcu_kit/README.md",tags:[],version:"current",frontMatter:{}},u={},c=[{value:"Feather M4 Can device setup",id:"feather-m4-can-device-setup",level:2},{value:"Flashing the UF2 firmware on the M4 device",id:"flashing-the-uf2-firmware-on-the-m4-device",level:3},{value:"On initial plug in",id:"on-initial-plug-in",level:5},{value:"On subsequent plug in",id:"on-subsequent-plug-in",level:5},{value:"WSL uf2 flashing",id:"wsl-uf2-flashing",level:4},{value:"Ubuntu uf2 flashing",id:"ubuntu-uf2-flashing",level:4},{value:"Mac OS uf2 flashing",id:"mac-os-uf2-flashing",level:4}],s={toc:c};function h(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"feather-m4-can-device-setup"},"Feather M4 Can device setup"),(0,r.kt)("p",null,"This device can be used for rapid prototyping of applications with farm-ng's Amiga platform."),(0,r.kt)("p",null,"The Feather M4 board front and back, where to solder the connector, and the resistor that must be cut:"),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{width:"773",title:"Feather M4 board front and back",alt:"Screen Shot 2022-08-16 at 7 34 34 PM",src:"https://user-images.githubusercontent.com/810997/185022043-bf6f20b6-f332-4e63-a050-be5f4248462c.png"})),(0,r.kt)("p",null,"The connected Feather M4 and which wire to screw into high and low sides and where the reset button is:"),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{width:"702",title:"Connected Feather M4",alt:"Screen Shot 2022-08-16 at 7 24 54 PM",src:"https://user-images.githubusercontent.com/810997/185021388-b290fd2b-f721-4e59-843b-c30ee245c51b.png"})),(0,r.kt)("p",null,"The male M12 CAN bus connector whose white (high) and blue (low) connectors are screwed into the Feather M4 and the male CAN bus connector is attached to the CAN bus:"),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{width:"650",title:"Male M12 CAN bus connector",alt:"Screen Shot 2022-08-16 at 7 41 38 PM",src:"https://user-images.githubusercontent.com/810997/185022824-593e543f-7899-4a65-93b0-9f07e97f8572.png"})),(0,r.kt)("h3",{id:"flashing-the-uf2-firmware-on-the-m4-device"},"Flashing the UF2 firmware on the M4 device"),(0,r.kt)("h5",{id:"on-initial-plug-in"},"On initial plug in"),(0,r.kt)("p",null,"Our goal is to have the Adafruit Feather show up as a CIRCUITPY directory for plugging it in, see\n",(0,r.kt)("a",{parentName:"p",href:"https://learn.adafruit.com/circuit-playground-lesson-number-0/usb-connection"},"this reference"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Plug in your feather to your computer probably using a Type-C (feather) to Type-C (computer connector).",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"You'll get randomly varying LED colors"))),(0,r.kt)("li",{parentName:"ul"},"Look for the little reset switch on the Feather board. Double click the reset button to enter bootloader mode\n",(0,r.kt)("a",{parentName:"li",href:"https://learn.adafruit.com/circuit-playground-lesson-number-0/reset-button-bootloader"},"(reference here)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The Feather should automatically remount and show up as FTHRCANBOOT"),(0,r.kt)("li",{parentName:"ul"},"This allows you to copy a Microsoft standard flash format uf2 file onto the device"))),(0,r.kt)("li",{parentName:"ul"},"For each OS, see below how to copy (flash) the ",(0,r.kt)("inlineCode",{parentName:"li"},"amiga-dev-kit/feather_m4_can/uf2s/adafruit-circuitpython-feather_m4_can-en_US-7.3.2.uf2")," file onto the Feather"),(0,r.kt)("li",{parentName:"ul"},"After the above, feather should reboot with the newly loaded firmware and now show up as CIRCUITPY")),(0,r.kt)("p",null,"Below are instructions for flashing under different operating systems."),(0,r.kt)("h5",{id:"on-subsequent-plug-in"},"On subsequent plug in"),(0,r.kt)("p",null,"When attaching a previously flashed Feather M4 device, it should automatically mount as CIRCUITPY. "),(0,r.kt)("h4",{id:"wsl-uf2-flashing"},"WSL uf2 flashing"),(0,r.kt)("p",null,"From a terminal, use the command line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/<to_your_base_directory>/amiga-dev-kit\nsudo ./mnt_feather_wsl.sh d # mount the feather in wsl, assuming the feather is presenting as the D: drive on windows.\ncp feather_m4_can/uf2s/adafruit-circuitpython-feather_m4_can-en_US-7.3.2.uf2 /mnt/d/\n")),(0,r.kt)("h4",{id:"ubuntu-uf2-flashing"},"Ubuntu uf2 flashing"),(0,r.kt)("p",null,"From a terminal, use the command line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/<to_your_base_directory>/amiga-dev-kit\ncp feather_m4_can/uf2s/adafruit-circuitpython-feather_m4_can-en_US-7.3.2.uf2 /media/$USERNAME/FTHRCANBOOT/\n")),(0,r.kt)("h4",{id:"mac-os-uf2-flashing"},"Mac OS uf2 flashing"),(0,r.kt)("p",null,"In your PyCharm terminal or system terminal, use the command line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/<to_your_base_directory>/amiga-dev-kit\ncp feather_m4_can/uf2s/adafruit-circuitpython-feather_m4_can-en_US-7.3.2.uf2 /Volumes/FTHRCANBOOT \n")),(0,r.kt)("p",null,"You can also drag and drop the file onto the volume in Finder, and it will automatically install the uf2.  The volume will dismount, and then remount showing up as CIRCUITPY.  "),(0,r.kt)("h1",{id:"loading-code-on-the-feather"},"Loading code on the Feather"),(0,r.kt)("p",null,"Now that you have a flashed Feather, time to load some code:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy the lib folder to the root of the Feather.  This gets added automatically to your python path.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Attach a serial terminal to the feather, so you can see std out."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"On mac (use autocomplete to get the correct usb modem) ",(0,r.kt)("inlineCode",{parentName:"li"},".../tty.usb<tab_for_autocomplete>"),":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"screen /dev/tty./dev/tty.usbmodem14201\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"On ubuntu:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"screen /dev/ttyACM0\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Now add a code.py file to the root of the Feather drive. Try copying the ",(0,r.kt)("inlineCode",{parentName:"li"},"examples/hello_main_loop/code.py"))),(0,r.kt)("p",null,"The feather will automatically reload. You run this command on the screen terminal which is now running on the Feather"),(0,r.kt)("h1",{id:"feather-m4-references"},"Feather M4 references"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The CircuitPython programming guide from Adafruit is ",(0,r.kt)("a",{parentName:"li",href:"https://learn.adafruit.com/circuitpython-essentials/circuitpython-essentials"},"here: programming docs")),(0,r.kt)("li",{parentName:"ul"},"The microcontroller is described ",(0,r.kt)("a",{parentName:"li",href:"https://learn.adafruit.com/adafruit-feather-m4-can-express"},"here: microcontroller")),(0,r.kt)("li",{parentName:"ul"},"The background on Circuitpy (that we showed you how to flash above) is ",(0,r.kt)("a",{parentName:"li",href:"https://learn.adafruit.com/adafruit-feather-m4-can-express/circuitpython-on-feather-m4-can"},"here: background"))))}h.isMDXComponent=!0}}]);