"use strict";(self.webpackChunkamiga_developers_website=self.webpackChunkamiga_developers_website||[]).push([[6536],{9734:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=s(4848),t=s(8453);const a={id:"dashboard-settings",title:"Dashboard Settings"},o="Amiga Dashboard Settings Example",r={id:"examples/dashboard_settings/dashboard-settings",title:"Dashboard Settings",description:"Before diving into this code, here's a quick heads-up on what you'll need to be familiar with:",source:"@site/docs/examples/dashboard_settings/README.md",sourceDirName:"examples/dashboard_settings",slug:"/examples/dashboard_settings/",permalink:"/docs/examples/dashboard_settings/",draft:!1,unlisted:!1,editUrl:"https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/examples/dashboard_settings/README.md",tags:[],version:"current",frontMatter:{id:"dashboard-settings",title:"Dashboard Settings"},sidebar:"examples",previous:{title:"Tool Control",permalink:"/docs/examples/tool_control/"},next:{title:"File Reader CAN",permalink:"/docs/examples/file_reader_can/"}},d={},l=[{value:"<code>ConfigRequestReply</code> details",id:"configrequestreply-details",level:2},{value:"1. Install the farm-ng Brain ADK package",id:"1-install-the-farm-ng-brain-adk-package",level:2},{value:"2. Install the example&#39;s dependencies",id:"2-install-the-examples-dependencies",level:2},{value:"Setup",id:"setup",level:3},{value:"Install",id:"install",level:3},{value:"3. Execute the Python script",id:"3-execute-the-python-script",level:2},{value:"4. Modify the script",id:"4-modify-the-script",level:2},{value:"5. Customize run",id:"5-customize-run",level:2},{value:"6. Expected output",id:"6-expected-output",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"amiga-dashboard-settings-example",children:"Amiga Dashboard Settings Example"})}),"\n",(0,i.jsxs)(n.admonition,{title:"Basic Knowledge Requirements",type:"info",children:[(0,i.jsx)(n.p,{children:"Before diving into this code, here's a quick heads-up on what you'll need to be familiar with:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Python Programming"}),": It's important to have a good grasp of Python, especially with concepts\nlike ",(0,i.jsx)(n.code,{children:"functions"}),", ",(0,i.jsx)(n.code,{children:"loops"}),", and ",(0,i.jsx)(n.code,{children:"classes"}),", since the example utilizes these fundamentals."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asynchronous Programming with asyncio"}),": Familiarity with Python's asyncio for writing concurrent\ncode using the ",(0,i.jsx)(n.code,{children:"async/await"})," syntax."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/concepts/canbus_service",children:(0,i.jsx)(n.strong,{children:"farm-ng Canbus Service Overview"})}),":\nThis overview provides a base understanding of the gRPC service the client you create will connect to."]}),"\n"]})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://github.com/farm-ng/farm-ng-amiga/blob/main/py/examples/dashboard_settings/main.py",children:(0,i.jsx)(n.strong,{children:"Amiga Dashboard Settings"})}),"\nexample is a basic way of showing how to query and set parameters\non the Amiga dashboard settings page from your Amiga brain."]}),"\n",(0,i.jsxs)(n.p,{children:["You can either run this example directly on a brain by ",(0,i.jsx)(n.code,{children:"ssh"}),"'ing in, or use your local PC.\nIf using your local PC, it should be either connected to the same local network as the brain\nor linked to it through ",(0,i.jsxs)(n.a,{href:"https://tailscale.com/",children:[(0,i.jsx)(n.strong,{children:"tailscale"}),"."]})]}),"\n",(0,i.jsxs)(n.p,{children:["The requirements to run this example are to have a\n",(0,i.jsx)(n.a,{href:"/docs/brain/",children:(0,i.jsx)(n.strong,{children:"farm-ng brain"})})," running the ",(0,i.jsx)(n.code,{children:"canbus service"}),", with a dashboard attached to your Amiga.\nThe ",(0,i.jsx)(n.code,{children:"RequestReply"})," calls will fail if there is no dashboard to communicate with on the CAN bus."]}),"\n",(0,i.jsxs)(n.p,{children:["Support for the ",(0,i.jsx)(n.code,{children:"READ"})," operation is added in dashboard firmware release ",(0,i.jsx)(n.code,{children:"v0.4.0"}),".\nSupport for the ",(0,i.jsx)(n.code,{children:"WRITE"})," and ",(0,i.jsx)(n.code,{children:"STORE"})," operations is implemented in dashboard firmware release ",(0,i.jsx)(n.code,{children:"v0.5.0"}),"."]}),"\n",(0,i.jsxs)(n.h2,{id:"configrequestreply-details",children:[(0,i.jsx)(n.code,{children:"ConfigRequestReply"})," details"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ConfigRequestReply"})," proto, and associated fields,\ncan be found at ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/farm-ng/farm-ng-amiga/blob/main/protos/farm_ng/canbus/amiga_v6.proto",children:"amiga_v6.proto"})}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-proto",children:"// ConfigRequestReply encapsulates an operation ID, value ID, unit of measurement,\n// value, and success status for a configuration request or reply operation.\n//\n// NOTE: The success field is only used for replies.\n// NOTE: The value field may be outside of the valid range for the value ID.\nmessage ConfigRequestReply {\n  uint32 node_id = 1;           // Node ID of the receiver (request) == sender (reply)\n  double stamp = 2;             // Received time, in host monotonic clock (seconds)\n\n  ConfigOperationIds op_id = 3; // The operation ID of the request/reply. REQUIRED for all operations.\n  ConfigValueIds val_id = 4;    // The value ID of the request/reply. REQUIRED for READ & WRITE operations.\n  ConfigValueUnits unit = 5;    // The unit of measurement for the value. REQUIRED for READ & WRITE operations.\n  bool success = 6;             // For replies, true if the request was successful, false otherwise.\n\n  oneof value {                 // Set one of the following fields based on the value ID.\n                                // Can be left unset for READ & STORE operations.\n    int32 int_value = 7;        // Used for integer values, e.g. PTO_CUR_DEV\n    double double_value = 8;    // Used for floating-point values, e.g. VEL_MAX\n    bool bool_value = 9;        // Used for boolean values, e.g. M10_ON\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"1-install-the-farm-ng-brain-adk-package",children:["1. Install the ",(0,i.jsx)(n.a,{href:"/docs/brain/brain-install",children:"farm-ng Brain ADK package"})]}),"\n",(0,i.jsx)(n.h2,{id:"2-install-the-examples-dependencies",children:"2. Install the example's dependencies"}),"\n",(0,i.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd farm-ng-amiga/\n"})}),"\n",(0,i.jsxs)(n.admonition,{title:"Recommended",type:"tip",children:[(0,i.jsx)(n.p,{children:"Create a virtual environment"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python3 -m venv venv\nsource venv/bin/activate\n"})})]}),"\n",(0,i.jsx)(n.h3,{id:"install",children:"Install"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd py/examples/dashboard_settings\npip install -r requirements.txt\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3-execute-the-python-script",children:"3. Execute the Python script"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["To run this script from your PC, you need to update the ",(0,i.jsx)(n.code,{children:"service_config.json"}),"\nby modifying the ",(0,i.jsx)(n.code,{children:"host"})," field with your Amiga brain name."]}),(0,i.jsxs)(n.p,{children:["Please check out ",(0,i.jsx)(n.a,{href:"/docs/concepts/system_overview/#where-to-run-the-examples",children:"Amiga Development 101"}),"\nfor more details."]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python main.py --service-config service_config.json\n"})}),"\n",(0,i.jsx)(n.h2,{id:"4-modify-the-script",children:"4. Modify the script"}),"\n",(0,i.jsxs)(n.p,{children:["Change the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"val_id"})})," (which parameter you are interacting with)\nand ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"op_id"})})," (which operation is being performed on that parameter)\nto query or modify other dashboard settings."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Be sure to change the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"unit"})})," to a compatible type!\nYou can't have a max velocity in ",(0,i.jsx)(n.code,{children:"VOLTS"}),"!"]})}),"\n",(0,i.jsxs)(n.p,{children:["You can find the full set of available ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ConfigOperationIds"})}),", ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ConfigValueIds"})}),", and ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ConfigValueUnits"})}),"\ndirectly in the protobufs, at ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/farm-ng/farm-ng-amiga/blob/main/protos/farm_ng/canbus/amiga_v6.proto",children:"amiga_v6.proto"})}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"5-customize-run",children:"5. Customize run"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ python main.py --help\nusage: Query / set dashboard config parameters. [-h] --service-config SERVICE_CONFIG [--store]\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --service-config SERVICE_CONFIG\n                        The canbus service config.\n  --store               Store the persistent parameters on the dashboard.\n"})}),"\n",(0,i.jsx)(n.h2,{id:"6-expected-output",children:"6. Expected output"}),"\n",(0,i.jsx)(n.p,{children:"You should see a printed stream of your requests and the corresponding replies.\nFor example, here we:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"READ"})," the dashboard's ",(0,i.jsx)(n.code,{children:"VEL_MAX"})," parameter in ",(0,i.jsx)(n.code,{children:"MPS"})," (meters per second)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WRITE"})," the dashboard's ",(0,i.jsx)(n.code,{children:"VEL_MAX"})," parameter in ",(0,i.jsx)(n.code,{children:"MPS"})," to ",(0,i.jsx)(n.code,{children:"0.254"})," (half the original)","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Note that ",(0,i.jsx)(n.code,{children:"success == true"})," and the value matches what we set!"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["We again ",(0,i.jsx)(n.code,{children:"READ"})," the dashboard's ",(0,i.jsx)(n.code,{children:"VEL_MAX"})," parameter in ",(0,i.jsx)(n.code,{children:"MPS"})," and confirm it is set to the new value"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"###################\nRequest:\nnode_id: 14\nop_id: READ\nval_id: VEL_MAX\nunit: MPS\n\n\nResponse:\nnode_id: 14\nstamp: 77157.560405717\nop_id: READ\nval_id: VEL_MAX\nunit: MPS\nsuccess: true\ndouble_value: 0.5334010124206543\n\n\n###################\nRequest:\nnode_id: 14\nop_id: WRITE\nval_id: VEL_MAX\nunit: MPS\ndouble_value: 0.254\n\n\nResponse:\nnode_id: 14\nstamp: 77157.939269035\nop_id: WRITE\nval_id: VEL_MAX\nunit: MPS\nsuccess: true\ndouble_value: 0.25399994850158691\n\n\n###################\nRequest:\nnode_id: 14\nop_id: READ\nval_id: VEL_MAX\nunit: MPS\n\n\nResponse:\nnode_id: 14\nstamp: 77159.068547232\nop_id: READ\nval_id: VEL_MAX\nunit: MPS\nsuccess: true\ndouble_value: 0.25399994850158691\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>r});var i=s(6540);const t={},a=i.createContext(t);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);