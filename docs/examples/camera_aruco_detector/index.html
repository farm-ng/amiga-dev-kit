<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/camera_aruco_detector/camera-aruco-detector" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Camera Aruco Detector | Farm-ng Developers</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://amiga.farm-ng.com/docs/examples/camera_aruco_detector/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Camera Aruco Detector | Farm-ng Developers"><meta data-rh="true" name="description" content="Before diving into this code, here&#x27;s a quick heads-up on what you&#x27;ll need to be familiar with:"><meta data-rh="true" property="og:description" content="Before diving into this code, here&#x27;s a quick heads-up on what you&#x27;ll need to be familiar with:"><link data-rh="true" rel="icon" href="/img/farm-ng_favicon.png"><link data-rh="true" rel="canonical" href="https://amiga.farm-ng.com/docs/examples/camera_aruco_detector/"><link data-rh="true" rel="alternate" href="https://amiga.farm-ng.com/docs/examples/camera_aruco_detector/" hreflang="en"><link data-rh="true" rel="alternate" href="https://amiga.farm-ng.com/docs/examples/camera_aruco_detector/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EWY2LBZNZX-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Farm-ng Developers RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Farm-ng Developers Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-235819376-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Farm-ng Developers" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.c29cff4a.css">
<script src="/assets/js/runtime~main.aaca10d5.js" defer="defer"></script>
<script src="/assets/js/main.2f0073f6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#20232a;color:#fff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Join Farm-ng Discourse forum ðŸ¤– ðŸšœ <a target="_blank" rel="noopener noreferrer" href="https://discourse.farm-ng.com/"> Announcements, Q&A, share codes or ideas.</a>.</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/farm-ng_favicon.png" alt="Amiga Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/farm-ng_favicon.png" alt="Amiga Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Amiga SDK</b></a><a class="navbar__item navbar__link" href="/docs/getting-started">Introduction</a><a class="navbar__item navbar__link" href="/docs/concepts/">Concepts</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/examples/examples-index">Examples</a><a class="navbar__item navbar__link" href="/docs/api/">API</a><a href="https://farm-ng.com/pages/about-farm-ng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About Us</a><a href="https://discourse.farm-ng.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discuss</a><a href="https://farm-ng.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Shop</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCczyy8tyLbqxjtLE1_8YW3w" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-youtube-link" aria-label="Youtube"></a><a href="https://github.com/farm-ng/amiga-dev-kit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/examples/examples-index">Examples Index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/examples/hello_main_loop/">CircuitPython Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/examples/events_recorder/">Brain Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/events_recorder/">Data Recording Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/file_reader/">Playback Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/examples/camera_client/">Camera Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/examples/camera_client/">Camera Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/examples/camera_settings/">Camera Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/examples/camera_calibration/">Camera Calibration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/examples/camera_aruco_detector/">Camera Aruco Detector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/examples/camera_pointcloud/">Camera Pointcloud</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/motor_state/">CAN Bus Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/gps_client/">GPS Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/filter_client/">State Estimation Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/track_recorder/">Track Follower Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/multi_client_subscriber/">Multi Client Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/service_client/">Custom Service Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/examples/vnc_viewer/">Miscellaneous Examples</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/brain/brain-apps">Amiga Brain Development</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Brain Examples</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Camera Examples</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Camera Aruco Detector</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Camera Aruco Detector</h1></header><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Basic Knowledge Requirements</div><div class="admonitionContent_BuS1"><p>Before diving into this code, here&#x27;s a quick heads-up on what you&#x27;ll need to be familiar with:</p><ol>
<li><strong>Python Programming</strong>: It&#x27;s important to have a good grasp of Python, especially with concepts
like <code>functions</code>, <code>loops</code>, and <code>classes</code>, since the example utilizes these fundamentals.</li>
<li><strong>Asynchronous Programming with asyncio</strong>: Familiarity with Python&#x27;s asyncio for writing concurrent
code using the <code>async/await</code> syntax.</li>
<li><strong>Understanding of ArUco Markers</strong>: Understand what ArUco markers are and how they function.
These markers are used for various applications in computer vision,
most commonly for camera calibration and pose estimation,
and this example specifically utilizes them for detecting their positions in image frames.</li>
<li><strong>Familiarity with OpenCV&#x27;s ArUco Library</strong>: The example uses OpenCV&#x27;s functionalities to handle ArUco
markers, including detection and pose estimation.
Knowledge of functions like <code>detectMarkers</code>, <code>drawDetectedMarkers</code>, and <code>estimatePoseSingleMarkers</code>
is important.</li>
<li><strong>Camera Calibration and 3D Geometry Concepts</strong>: Knowledge of camera intrinsic parameters
to compute the camera matrix and distortion coefficients.
Knowing how these parameters influence the projection of 3D points onto a 2D image is important.</li>
<li><strong>Experience with Image Processing and Decoding</strong>: Users should be comfortable with image manipulation
tasks, as the example involves converting images to grayscale for marker.</li>
<li><strong><a href="/docs/concepts/oak_service/">farm-ng Oak Service Overview</a></strong>:
This overview provides a base understanding of the gRPC service the client you create will connect to.</li>
</ol></div></div>
<p>In the <a href="https://github.com/farm-ng/farm-ng-amiga/blob/main/py/examples/camera_aruco_detector/main.py" target="_blank" rel="noopener noreferrer"><strong>Camera ArUco</strong></a>
example we are going show how to implement a simple Aruco marker detector
using the <a href="https://opencv.org/" target="_blank" rel="noopener noreferrer"><strong>OpenCV</strong></a> library and the Camera service to
detect and estimate the 6DoF pose of an Aruco marker useful for robot localization.</p>
<p>To understand the basics of the Aruco marker detection and pose estimation, please
refer to the <a href="https://docs.opencv.org/master/d5/dae/tutorial_aruco_detection.html" target="_blank" rel="noopener noreferrer"><strong>OpenCV Aruco tutorial</strong></a>.</p>
<p>We also recommend to read first the
<a href="/docs/examples/camera_client"><strong><code>Camera Client</code></strong></a> and
<a href="/docs/examples/camera_calibration"><strong><code>Camera Calibration</code></strong></a> tutorials.</p>
<p>To successfully run this example, you must use your local PC, as the example won&#x27;t
work if executed directly from a brain (because of the popup window).
Ensure that a <a href="/docs/brain/"><strong>farm-ng brain</strong></a> running Oak cameras is active.
Your local PC should be either connected to the same local network as the brain
or linked to it through tailscale.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-install-the-farm-ng-brain-adk-package">1. Install the <a href="/docs/brain/brain-install">farm-ng Brain ADK package</a><a href="#1-install-the-farm-ng-brain-adk-package" class="hash-link" aria-label="Direct link to 1-install-the-farm-ng-brain-adk-package" title="Direct link to 1-install-the-farm-ng-brain-adk-package">â€‹</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-install-the-examples-dependencies">2. Install the example&#x27;s dependencies<a href="#2-install-the-examples-dependencies" class="hash-link" aria-label="Direct link to 2. Install the example&#x27;s dependencies" title="Direct link to 2. Install the example&#x27;s dependencies">â€‹</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>It is recommended to also install these dependencies and run the
example in the brain ADK virtual environment.</p></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># assuming you&#x27;re already in the amiga-dev-kit/ directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd farm-ng-amiga/py/examples/camera_aruco_detector</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install -r requirements.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is will install the following dependencies:</p>
<ul>
<li><code>farm-ng-amiga</code> - the farm-ng python client library</li>
<li><code>opencv-python</code> - the OpenCV python library</li>
<li><code>opencv-contrib-python</code> - the OpenCV python library with extra modules (needed for Aruco detection)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-the-aruco-detector">3. The Aruco detector<a href="#3-the-aruco-detector" class="hash-link" aria-label="Direct link to 3. The Aruco detector" title="Direct link to 3. The Aruco detector">â€‹</a></h3>
<p>In order to detect the Aruco markers, we need to create an Aruco detector object and
configure it with the desired parameters. To do this, we&#x27;ll create an auxiliary class
<code>ArucoDetector</code> that will hold the detector object and the configuration parameters.</p>
<p>In this example, we&#x27;ll use the <code>DICT_6X6_250</code> Aruco dictionary type and a marker size of 0.1 meters
to detect the Aruco markers following the <a href="https://docs.opencv.org/master/d5/dae/tutorial_aruco_detection.html" target="_blank" rel="noopener noreferrer"><strong>OpenCV Aruco tutorial</strong></a>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class ArucoDetector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;&quot;&quot;A class for detecting ArUco markers in an image frame.&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def __init__(self, aruco_dict_type: str, marker_size: float) -&gt; None:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;Initialize the ArUco detector.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            aruco_dict_type (str): The ArUco dictionary type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            marker_size (float): The size of the ArUco marker in meters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self._detector = self._create_detector(aruco_dict_type)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self._marker_size = marker_size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def _create_detector(self, aruco_dict_type: str) -&gt; cv2.aruco.ArucoDetector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;Create an ArUco detector.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            aruco_dict_type (str): The ArUco dictionary type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cv2.aruco.ArucoDetector: The ArUco detector.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        aruco_params = cv2.aruco.DetectorParameters()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # See all the available ArUco dictionary types here:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # https://docs.opencv.org/4.x/de/d67/group__objdetect__aruco.html#ga4e13135a118f497c6172311d601ce00d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        aruco_dict = cv2.aruco.getPredefinedDictionary(getattr(cv2.aruco, aruco_dict_type))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return cv2.aruco.ArucoDetector(aruco_dict, aruco_params)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will also create a couple of internal utilities to create the reference 3d points needed by the
pose estimation solver.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    def _create_object_points(self, marker_size: float) -&gt; np.ndarray:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;Create the object points for the ArUco markers.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            marker_size (float): The size of the ArUco marker in meters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            np.ndarray: The object points for the ArUco markers.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        size_half: float = marker_size / 2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return np.array(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [-size_half, -size_half, 0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [size_half, -size_half, 0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [size_half, size_half, 0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [-size_half, size_half, 0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dtype=np.float32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As described in the <a href="/docs/examples/camera_pointcloud"><strong>Camera to Pointcloud</strong></a>
tutorial, we need to create a camera intrinsics matrix
from the camera calibration parameters. We&#x27;ll create a utility function to do this.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@staticmethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def get_camera_matrix(camera_data: oak_pb2.CameraData) -&gt; np.ndarray:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;&quot;&quot;Compute the camera matrix from the camera calibration data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        camera_data (oak_pb2.CameraData): The camera calibration data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tensor: The camera matrix with shape 3x3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fx = camera_data.intrinsic_matrix[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fy = camera_data.intrinsic_matrix[4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cx = camera_data.intrinsic_matrix[2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cy = camera_data.intrinsic_matrix[5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return np.array([[fx, 0, cx], [0, fy, cy], [0, 0, 1]])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally, we&#x27;ll create a method to detect the Aruco markers in an image frame and estimate their
pose that can be used later to build other applications. In this example, for educational purposes,
we will render the 3d detection into the original image.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">def detect_pose(self, frame: np.ndarray, camera_matrix: np.ndarray, distortion_coeff: np.ndarray):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;&quot;&quot;Detect ArUco markers in an image frame.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            frame (np.ndarray): The image frame in rgb format with shape HxWx3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            camera_matrix (np.ndarray): The camera matrix with shape 3x3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            distortion_coeff (np.ndarray): The distortion coefficients with shape 1x5.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert len(frame.shape) == 3 and frame.shape[2] == 3, &quot;image must be rgb&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Convert the image to grayscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gray = cv2.cvtColor(frame, cv2.COLOR_RGB2GRAY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Detect the markers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    corners, _, _ = self._detector.detectMarkers(gray)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Detected {len(corners)} markers&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rvec = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tvec = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    frame_vis = frame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for corner in corners:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Estimate the pose of the marker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _rvec, _tvec, _ = cv2.aruco.estimatePoseSingleMarkers(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            corner, self._marker_size, camera_matrix, distortion_coeff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # sotre the results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rvec.append(_rvec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tvec.append(_tvec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Draw the detected marker and its pose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        frame_vis = cv2.drawFrameAxes(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            frame, camera_matrix, distortion_coeff, _rvec, _tvec, self._marker_size * 0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Draw the detected markers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    frame_vis = cv2.aruco.drawDetectedMarkers(frame_vis, corners)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return (np.array(rvec), np.array(tvec)), frame_vis</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-the-main-function">4. The main function<a href="#4-the-main-function" class="hash-link" aria-label="Direct link to 4. The main function" title="Direct link to 4. The main function">â€‹</a></h3>
<p>Now that we have the Aruco detector, we can create the main function from where we&#x27;ll
first request the camera calibration data and then subscribe to the camera service to receive
the camera stream and detect the Aruco markers. Finally, we&#x27;ll visualize the detections in the
original image using OpenCV.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create a client to the camera service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config: EventServiceConfig = proto_from_json_file(args.service_config, EventServiceConfig())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># create the camera client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">camera_client = EventClient(config)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># request the camera calibration data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">calibration: oak_pb2.OakCalibration = await camera_client.request_reply(&quot;/calibration&quot;, Empty(), decode=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># create the ArUco detector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">detector = ArucoDetector(aruco_dict_type=args.aruc_type, marker_size=args.marker_size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># NOTE: The OakCalibration message contains the camera calibration data for all the cameras.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Since we are interested in the disparity image, we will use the calibration data for the right camera</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># which is the first camera in the list.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">camera_matrix: np.ndarray = detector.get_camera_matrix(calibration.camera_data[0])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distortion_coeff = np.array(calibration.camera_data[0].distortion_coeff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async for event, message in camera_client.subscribe(config.subscriptions[0], decode=True):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # cast image data bytes to numpy and decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: np.ndarray = cv2.imdecode(np.frombuffer(message.image_data, dtype=&quot;uint8&quot;), cv2.IMREAD_UNCHANGED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # detect the aruco markers in the image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # NOTE: do something with the detections here, e.g. publish them to the event service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    detections, image_vis = detector.detect_pose(image, camera_matrix, distortion_coeff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # visualize the image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv2.namedWindow(&quot;image&quot;, cv2.WINDOW_NORMAL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv2.imshow(&quot;image&quot;, image_vis)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv2.waitKey(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-execute-the-python-script">5. Execute the Python script<a href="#5-execute-the-python-script" class="hash-link" aria-label="Direct link to 5. Execute the Python script" title="Direct link to 5. Execute the Python script">â€‹</a></h3>
<p>To run this script from your PC, you need to update the <code>service_config.json</code>
by modifying the <code>host</code> filed with your Amiga brain name (e.g., <code>element-vegetable</code>).</p>
<p>You can also stream the stereo left or right images or the camera&#x27;s disparity by changing
the <code>path</code> field (e.g., /left) or change the port and service name to instead stream
the Oak1 camera.</p>
<p>In order to run the example, we need to provide the path to the camera service config file</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 main.py --service-config service_config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Optionally, we can also provide the Aruco dictionary type and the marker size</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 main.py --service-config service_config.json --aruco-type DICT_6X6_250 --marker-size 0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The example will open a window with the camera stream and the detected Aruco markers.</p>
<p><img loading="lazy" src="https://github.com/farm-ng/amiga-dev-kit/assets/5157099/a0a1abb4-4727-4c2e-be76-b94868dd75fa" alt="Screenshot from 2023-10-06 16-34-59" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/farm-ng/amiga-dev-kit/tree/main/website/docs/examples/camera_aruco_detector/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/examples/camera_calibration/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Camera Calibration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/examples/camera_pointcloud/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Camera Pointcloud</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-install-the-farm-ng-brain-adk-package" class="table-of-contents__link toc-highlight">1. Install the farm-ng Brain ADK package</a></li><li><a href="#2-install-the-examples-dependencies" class="table-of-contents__link toc-highlight">2. Install the example&#39;s dependencies</a></li><li><a href="#3-the-aruco-detector" class="table-of-contents__link toc-highlight">3. The Aruco detector</a></li><li><a href="#4-the-main-function" class="table-of-contents__link toc-highlight">4. The main function</a></li><li><a href="#5-execute-the-python-script" class="table-of-contents__link toc-highlight">5. Execute the Python script</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/examples/examples-index">Examples</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api">API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discourse.farm-ng.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contribute/contribute-website">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">farm-ng and sister projects</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://farm-ng.github.io/farm-ng-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">farm-ng-core<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://strasdat.github.io/Sophus/latest/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sophus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/stevenlovegrove/Pangolin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pangolin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://amiga.farm-ng.com/docs/getting-started" target="_blank" rel="noopener noreferrer" class="footer__link-item">Amiga Development Kit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/release-notes/release-02">Release Notes</a></li><li class="footer__item"><a href="https://github.com/farm-ng/amiga-dev-kit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/farm-ng/amiga-dev-kit/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Farm-ng, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>